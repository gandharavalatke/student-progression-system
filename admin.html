<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Student Progression System</title>
    <link rel="icon" type="image/png" href="git-logo.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%); 
            background-attachment: fixed; 
        }
        .upload-box:hover { 
            border-color: #3b82f6; 
            background-color: rgba(59, 130, 246, 0.1); 
        }
        .modal-overlay { transition: opacity 0.3s ease; }
        .modal-box { transition: all 0.3s ease; transform: translateY(-50px); }
        .modal-overlay:not(.hidden) .modal-box { transform: translateY(0); }
        .admin-card {
            background: linear-gradient(145deg, #1e293b 0%, #334155 100%);
            border: 1px solid rgba(59, 130, 246, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="text-white">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-xl p-8 space-y-6 admin-card rounded-2xl shadow-2xl">
            <div class="text-center">
                <img src="GIT Logo.jpg" alt="GIT Logo" class="w-auto h-12 mx-auto mb-4">
                <h2 class="text-2xl font-bold text-white">Administrator Panel</h2>
                <p id="subtitle" class="text-slate-300">Enter password to continue.</p>
            </div>
            <div id="password-section">
                <form id="admin-login-form" class="space-y-4">
                    <div class="relative">
                        <i class="fa-solid fa-shield-halved absolute left-4 top-1/2 -translate-y-1/2 text-blue-400"></i>
                        <input type="password" id="admin-password" placeholder="Admin Password" required class="block w-full pl-12 pr-4 py-3 bg-slate-800/50 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all backdrop-blur-sm">
                    </div>
                    <button type="submit" id="admin-login-btn" class="w-full h-12 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-lg hover:from-blue-700 hover:to-blue-800 flex items-center justify-center shadow-lg transition-all transform hover:scale-[1.02] focus:ring-4 focus:ring-blue-500/20">
                        <span id="auth-btn-text">Authenticate</span>
                        <div id="auth-spinner" class="w-5 h-5 border-2 border-t-transparent border-white rounded-full animate-spin ml-2 hidden"></div>
                    </button>
                    <p id="auth-error" class="text-red-400 text-sm text-center h-5"></p>
                </form>
            </div>
            <div id="upload-section" class="hidden">
                 <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-600 backdrop-blur-sm">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center">
                        <i class="fa-solid fa-users-cog mr-3 text-blue-400"></i>Upload Faculty List
                    </h3>
                    <div id="upload-box" class="p-6 rounded-xl text-center border-2 border-dashed border-slate-500 cursor-pointer transition-colors duration-200 upload-box bg-slate-800/30">
                        <i class="fa-solid fa-file-excel text-4xl text-green-400 mx-auto mb-3"></i>
                        <p id="upload-text" class="text-slate-300">Click to select an Excel file</p>
                        <input type="file" id="faculty-file-input" class="hidden" accept=".xlsx, .xls">
                    </div>
                    <div class="flex justify-end mt-4">
                        <button id="upload-btn" class="px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-lg hover:from-blue-700 hover:to-blue-800 flex items-center disabled:opacity-50 shadow-lg transition-all transform hover:scale-[1.02] focus:ring-4 focus:ring-blue-500/20" disabled>
                            <span id="upload-btn-text">Upload List</span>
                            <div id="upload-spinner" class="w-5 h-5 border-2 border-t-transparent border-white rounded-full animate-spin ml-2 hidden"></div>
                        </button>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a href="index.html" class="text-sm text-blue-400 hover:text-blue-300 hover:underline transition-colors">Return to Login Page</a>
            </div>
        </div>
    </div>
    <div id="result-modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div id="result-modal" class="modal-box bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-md text-center border border-slate-600">
            <div id="result-icon-bg" class="mx-auto flex items-center justify-center h-12 w-12 rounded-full mb-4">
                <i id="result-icon" class="fa-solid text-xl text-white"></i>
            </div>
            <h3 class="text-lg leading-6 font-medium text-white" id="result-title"></h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-slate-300" id="result-message"></p>
            </div>
            <div class="mt-5 sm:mt-6">
                <button id="result-close-btn" class="w-full rounded-md border border-transparent shadow-sm px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 font-medium text-white hover:from-blue-700 hover:to-blue-800 transition-all">Close</button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('admin-login-form');
            const pwd = document.getElementById('admin-password');
            const authErr = document.getElementById('auth-error');
            const authBtn = document.getElementById('admin-login-btn');
            const uploadBox = document.getElementById('upload-box');
            const input = document.getElementById('faculty-file-input');
            const uploadBtn = document.getElementById('upload-btn');
            const uploadText = document.getElementById('upload-text');
            const subtitle = document.getElementById('subtitle');
            const passwordSection = document.getElementById('password-section');
            const uploadSection = document.getElementById('upload-section');

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                authErr.textContent = '';
                try {
                    const res = await fetch('https://student-progression-system-production-02da.up.railway.app/api/admin/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ password: pwd.value })
                    });
                    const data = await res.json();
                    if (!res.ok) throw new Error(data.message);
                    passwordSection.classList.add('hidden');
                    uploadSection.classList.remove('hidden');
                    subtitle.textContent = 'Upload an Excel file with faculty details.';
                } catch (err) {
                    authErr.textContent = err.message;
                }
            });

            uploadBox.addEventListener('click', () => input.click());
            input.addEventListener('change', () => {
                if (input.files && input.files[0]) {
                    uploadText.textContent = input.files[0].name;
                    uploadBtn.disabled = false;
                }
            });

            uploadBtn.addEventListener('click', async () => {
                if (!input.files || !input.files[0]) return;
                const confirmUpload = await showConfirm('Are you sure you want to upload this file?');
                if (!confirmUpload) return;
                const formData = new FormData();
                formData.append('file', input.files[0]);
                try {
                    const res = await fetch('https://student-progression-system-production-02da.up.railway.app/api/upload-faculty', {
                        method: 'POST',
                        body: formData
                    });
                    const data = await res.json();
                    if (!res.ok) throw new Error(data.message || 'Upload failed');
                    await showAlert('File uploaded successfully.');
                    uploadText.textContent = 'Click to select an Excel file';
                    input.value = '';
                    uploadBtn.disabled = true;
                } catch (err) {
                    await showAlert(`Upload failed: ${err.message}`);
                }
            });
            function showAlert(message) {
                return new Promise((resolve) => {
                    const overlay = document.createElement('div');
                    overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50';
                    overlay.innerHTML = `<div class="bg-white rounded-xl shadow-2xl border border-orange-200 w-full max-w-md p-6 text-center"><div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-orange-100 mb-3"><i class=\"fa-solid fa-circle-info text-orange-500 text-xl\"></i></div><h3 class=\"text-gray-800 text-lg font-semibold mb-2\">Notice</h3><p class=\"text-gray-600 mb-5\">${message}</p><button id=\"modal-ok\" class=\"px-5 py-2 bg-gradient-to-r from-orange-400 to-orange-500 text-white rounded-lg hover:from-orange-500 hover:to-orange-600\">OK</button></div>`;
                    document.body.appendChild(overlay);
                    overlay.querySelector('#modal-ok').addEventListener('click', () => { document.body.removeChild(overlay); resolve(true); });
                });
            }
            function showConfirm(message) {
                return new Promise((resolve) => {
                    const overlay = document.createElement('div');
                    overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50';
                    overlay.innerHTML = `<div class=\"bg-white rounded-xl shadow-2xl border border-orange-200 w-full max-w-md p-6 text-center\"><div class=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 mb-3\"><i class=\"fa-solid fa-triangle-exclamation text-yellow-600 text-xl\"></i></div><h3 class=\"text-gray-800 text-lg font-semibold mb-2\">Confirm</h3><p class=\"text-gray-600 mb-5\">${message}</p><div class=\"space-x-3\"><button id=\"modal-cancel\" class=\"px-5 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\">Cancel</button><button id=\"modal-ok\" class=\"px-5 py-2 bg-gradient-to-r from-orange-400 to-orange-500 text-white rounded-lg hover:from-orange-500 hover:to-orange-600\">OK</button></div></div>`;
                    document.body.appendChild(overlay);
                    overlay.querySelector('#modal-cancel').addEventListener('click', () => { document.body.removeChild(overlay); resolve(false); });
                    overlay.querySelector('#modal-ok').addEventListener('click', () => { document.body.removeChild(overlay); resolve(true); });
                });
            }
        });
    </script>
</body>
</html>
</html>